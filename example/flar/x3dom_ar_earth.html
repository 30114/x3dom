<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0014)about:internet -->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">	
    <head>
        <title>Augmented Reality with X3DOM and FLARToolkit</title>
        <link rel="stylesheet" type="text/css" href="../x3dom.css" />
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>  

        <style type="text/css">
			
			#topLayer {
			  position:absolute;
			  /*top:30px; left:575px;*/
			  /*top:25px; left:10px;*/
			  z-index:5;
			  width:640px;
			  height:480px;
			  overflow:hidden;
			  padding:0;
			  margin:0;				
			}
			

		</style>		
		
        <script type="text/javascript">
		
		
        	var texture_changed = false;
        	var latr, lngr
        	
			function trace(matrix) {
				if (!(matrix instanceof Array)) { return; }
				
				var str = "";
				
				for (var i = 0; i < matrix.length; i++)
				{
					for (var j = 0; j < matrix[i].length; j++)
					{
                        str += (matrix[i][j].toString() + "000").substr(0,4) + " ";
					}
					str += "<br/>"
				}
				return str;
			}
			
			function js_detected(value) {
				$('#topLayer').show();
			}
			
			function js_notdetected(value) {
				$('#topLayer').hide();
			}
			
			//This function is triggered within flash 
			//and distinguished by its name
			function get_js_transMatrix(value) {
				var q = (value);
				var myMatrixTrans = document.getElementsByTagName('MatrixTransform')[0];
				// Shift Values:
				// Convert rotation form left>right
				// shift z
				q[2][3] = -q[2][3];
				q[0][2] = -q[0][2];
				q[1][2] = -q[1][2];
				q[2][0] = -q[2][0];
				q[2][1] = -q[2][1];
				
				myMatrixTrans.setAttribute('matrix', q);
				
				$('#flash_receiver').html("MATRIX <br/>" + trace(q));
    		}
			
			function get_js_viewMatrix(value) {
				var q = (value);
				var myVP = document.getElementsByTagName('Viewpoint')[0];
				// Shift Values:
				// Convert rotation form left>right
				// shift z
				q[2][3] = -q[2][3];
				q[0][2] = -q[0][2];
				q[1][2] = -q[1][2];
				q[2][0] = -q[2][0];
				q[2][1] = -q[2][1];
				
				myVP.setAttribute('matrix', q);
			}
			
			
        </script>
    </head>
    <body>

    	<h1>Augmented Reality with X3DOM and FLARToolkit</h1>

		<p>
			This Demo makes use of Adobe Flash based FLARToolkit for marker tracking and X3DOM for 3D rendering. 
			<br />Please print out this marker: <a href='Data/flarlogo-marker.pdf'>flarlogo-marker.pdf</a> or 
			<a href='Data/flarlogo-marker.png'>flarlogo-marker.png</a>
			<br/> and point it to the camera.
		</p>
<div id="root_canvas">
	<div id="topLayer" style="display:none; border:1px solid red;">
		<div id='x3div' >
		<x3d id='x3d' showStat="false" showLog="false" x="0px" y="0px" width="640px" height="480px" altImg="helloX3D-alt.png">
			<scene>
				<viewpoint fieldOfView='0.60' position='0 0 0'></viewpoint>

				<background transparency="1" skyColor='0 0 0'></background>
				
				<matrixtransform>
					<transform def='universe' translation='0 0 0' scale='60 60 60'>
						<transform def='earth' rotation='1 0 0 -1.57'>
							<shape>
								<appearance>
									<imageTexture url='"http://veimages.gsfc.nasa.gov/2430/land_ocean_ice_2048.jpg"'>
									</imageTexture>
								</appearance>

								<sphere lit='false'>
								</sphere>
							</shape>
						</transform>
						
						<transform def='clouds' rotation='1 0 0 -1.57' scale='1.1 1.1 1.1'>
							<shape>
								<appearance>
									<imageTexture url='"http://www.barnabu.co.uk/files/clouds/cloudimage.png"'>
									</imageTexture>

								</appearance>
								<sphere solid='false' lit='false'>
								</sphere>
							</shape>
						</transform>
					</transform>
				</matrixtransform>
				
				<!--<orientationInterpolator def='oi' keyValue='0 0 1 0, 0 0 1 3.14, 0 0 1 6.28' key='0 0.5 1'></orientationInterpolator>
				<route fromNode='oi' fromField='value_changed' toNode='universe' toField='set_rotation'></route>
			
				<timesensor def='t' cycleinterval='100' loop='TRUE'></timesensor>
				<route fromNode='t' fromField='fraction_changed' toNode='oi' toField='set_fraction'></route>-->
			</scene>

		</x3d>
		</div>
	</div>
		
	<div id="flashmovie2" style="position:absolute; z-index:-10;">
		<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="640" height="480" id="x3domflartoolkit" align="middle">
			<param name="allowScriptAccess" value="always" />
			<param name="allowFullScreen" value="false" />
			<param name="wmode" value="transparent" />
			<param name="movie" value="x3domflartoolkit.swf" />
			<param name="quality" value="high" /><param name="bgcolor" value="#808080" />	
			<embed wmode="transparent" src="x3domflartoolkit.swf" quality="high" bgcolor="#808080" width="640" height="480" name="SimpleCube" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.adobe.com/go/getflashplayer_de" />
		</object>
	</div>
</div>

		
		<!--script type="text/javascript" src="../x3dom.js"></script-->
		<script type="text/javascript" src="http://www.x3dom.org/x3dom/example/x3dom.js"></script>		
		
   </body>
</html>
