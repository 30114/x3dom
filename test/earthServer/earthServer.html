<!DOCTYPE >
<html>
<head>
	    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
		<title>Earth Demo</title>
		
		<link rel="stylesheet" type="text/css" href="css/x3dom.css" />
		<script type="text/javascript" src="js/x3dom-full.js"></script>
		<link rel="stylesheet" href="css/jquery-ui.css" type="text/css" media="all">
		<script src="js/jquery-1.7.1.min.js" type="text/javascript"></script>

<script>
	$(document).ready(function() {
		$.ajax({
				url: 'http://kalyke.eox.at/eoxserver/ows',
				type: 'GET',
				dataType: "xml",
				async: false,
				data: 'service=wcs&version=2.0.0&request=describeeocoverageset&eoid=IMAGE2009_rgb',
				success:  function(xml) {
					
					var resultTime = 	$(xml).find('beginPosition');
					
					resultTime.each(function(index){
											 
						var img = $(this).text();
						img = img.replace(" " , "");
						var posy = ((1000/resultTime.lenght)*index) - 500;
						var posx = 0;
						var posz = 0;
						var bbox = '35,4,49,18';
						var width = '1000'
						var height = '1000'
						
						$('#trans').append("<Transform translation='"+posz+" "+posx+" "+posy+"'><shape><appearance><imageTexture url='http://kalyke.eox.at/eoxserver/ows?service=wms&version=1.3.0&request=getmap&layers=IMAGE2009_rgb&styles=&transparent=true&format=image/png&crs=epsg:4326&bbox="+bbox+"&width="+width+"&height="+height+"&time="+img+"'></imageTexture></appearance><Rectangle2D onclick='getData()' size='1000 1000' subdivision='1 1' ></Rectangle2D></shape></Transform>");	
						
					});
				},
				error: function(xhr, ajaxOptions, thrownError) {
					alert("error" + xhr.status +" " + ajaxOptions + " " + thrownError);
				}
		});
		var getData = function(){
				alert('hallo');
		};
					

	});	
</script>
<style>
	
</style>
</head>
<body>
     <div class="group">
         <X3D width="700px" height="700px">
            <scene>
                <Background skyColor='0.5 0.5 0.5'></Background>
				<Viewpoint position="50 0 2300"></Viewpoint>
				<Transform rotation='1 0 0 0.3'>
                <Transform rotation='0 1 0 -0.3'>
					<Shape>
						<Appearance>
						  <Material emissiveColor ="1 1 0"></Material>
						</Appearance>
						<IndexedLineSet colorPerVertex="false" coordIndex="0 1 2 3 0 -1 4 5 6 7 4 -1 0 4 -1 1 5 -1 2 6 -1 3 7 -1">
							<Coordinate point=" -500 -500 -500
                                                 500 -500 -500
                                                 500  500 -500
                                                -500  500 -500
                                                -500 -500  500
                                                 500 -500  500
                                                 500  500  500
                                                -500  500  500" />
						</IndexedLineSet>
                   </Shape>		
                   <Transform id="trans" rotation="1 0 0 -1.57079">
                        <Transform translation="0 0 -500">
                            <shape>
                                <appearance>
                                  <imageTexture id="texture1" url='http://kalyke.eox.at/eoxserver/ows?service=wms&version=1.3.0&request=getmap&layers=IMAGE2009_rgb&styles=&transparent=true&format=image/png&crs=epsg:4326&bbox=35,4,49,18&width=1000&height=1000'></imageTexture>
                                </appearance>
                                <Rectangle2D id="rectangle1" size="1000 1000"subdivision='1 1' ></Rectangle2D>
                              </shape>      
                        </Transform>	    
                    </Transform>									
				</Transform>
                </Transform>
            </scene>
        </X3D>
    </div>            
   

</body>
</html>
