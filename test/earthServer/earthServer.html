<!DOCTYPE >
<html>
<head>
	    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
		<title>Earth Demo</title>
		
		<link rel="stylesheet" type="text/css" href="css/x3dom.css" />
		<script type="text/javascript" src="js/x3dom-full.js"></script>   
        
       <!-- BEGIN:X3DOM
<link rel="stylesheet" type="text/css" href="../../src/x3dom.css" />
<script type="text/javascript" src="../../src/lang/Array.js"></script>
<script type="text/javascript" src="../../src/Internals.js"></script>
<script type="text/javascript" src="../../src/debug.js"></script>
<script type="text/javascript" src="../../src/ImageLoadManager.js"></script>
<script type="text/javascript" src="../../src/lang/Properties.js"></script>
<script type="text/javascript" src="../../src/lang/DoublyLinkedList.js"></script>
<script type="text/javascript" src="../../src/X3DCanvas.js"></script>
<script type="text/javascript" src="../../src/Runtime.js"></script>
<script type="text/javascript" src="../../src/Main.js"></script>
<script type="text/javascript" src="../../src/gfx_webgl.js"></script>
<script type="text/javascript" src="../../src/gfx_flash.js"></script>
<script type="text/javascript" src="../../src/X3DDocument.js"></script>
<script type="text/javascript" src="../../src/MatrixMixer.js"></script>
<script type="text/javascript" src="../../src/Viewarea.js"></script>
<script type="text/javascript" src="../../src/Mesh.js"></script>
<script type="text/javascript" src="../../src/fields.js"></script>
<script type="text/javascript" src="../../src/nodes/NodeNameSpace.js"></script>
<script type="text/javascript" src="../../src/nodes/Core.js"></script>
<script type="text/javascript" src="../../src/nodes/Grouping.js"></script>
<script type="text/javascript" src="../../src/nodes/Bindable.js"></script>
<script type="text/javascript" src="../../src/nodes/Rendering.js"></script>
<script type="text/javascript" src="../../src/nodes/Shape.js"></script>
<script type="text/javascript" src="../../src/nodes/Lighting.js"></script>
<script type="text/javascript" src="../../src/nodes/Followers.js"></script>
<script type="text/javascript" src="../../src/nodes/Interpolation.js"></script>
<script type="text/javascript" src="../../src/nodes/Time.js"></script>
<script type="text/javascript" src="../../src/nodes/Networking.js"></script>
<script type="text/javascript" src="../../src/nodes/EnvironmentalEffects.js"></script>
<script type="text/javascript" src="../../src/nodes/Navigation.js"></script>
<script type="text/javascript" src="../../src/nodes/Text.js"></script>
<script type="text/javascript" src="../../src/nodes/Sound.js"></script>
<script type="text/javascript" src="../../src/nodes/Texturing.js"></script>
<script type="text/javascript" src="../../src/nodes/Shaders.js"></script>
<script type="text/javascript" src="../../src/nodes/Geometry3D.js"></script>
<script type="text/javascript" src="../../src/nodes/Geometry2D.js"></script>
<script type="text/javascript" src="../../src/nodes/Geospatial.js"></script>
 END:X3DOM -->  
        
        
           
		<link rel="stylesheet" href="css/jquery-ui.css" type="text/css" media="all">
		<script src="js/jquery-1.7.1.min.js" type="text/javascript"></script>

<script>
	$(document).ready(function() {
		$.ajax({
				url: 'http://kalyke.eox.at/eoxserver_timm/ows',
				type: 'GET',
				dataType: "xml",
				async: false,
				data: 'service=wcs&version=2.0.0&request=describeeocoverageset&eoid=IMAGE2009_rgb',
				success:  function(xml) {
					var CoverageDescription = 	$(xml).find('CoverageDescription');
					
					CoverageDescription.each(function(index){				 
						var img = $(this).find('beginPosition').text().replace(" " , "");
						var posy = 0;
						var posx = 0;
						var posz = 0;
						
						var box = $(this).find('lowerCorner').text().split(" ");
						box = box.concat($(this).find('upperCorner').text().split(" "));
						var bbox = box[0].slice(0,2)
						+ ',' + box[1].slice(0,2)
						+ ',' +box[2].slice(0,2)
						+ ',' +box[3].slice(0,2);
						
						var width = '1000';
						var height = '1000';
						
						$('#trans').append("<Transform translation='0 0 0'><shape><appearance><imageTexture url='http://kalyke.eox.at/eoxserver_timm/ows?service=wms&version=1.3.0&request=getmap&layers=IMAGE2009_rgb&styles=&transparent=true&format=image/png&crs=epsg:4326&bbox="+bbox+"&width="+width+"&height="+height+"&time="+img+"'></imageTexture></appearance><Rectangle2D onclick='alert("+bbox+")' size='1000 1000' subdivision='1 1' ></Rectangle2D></shape></Transform>");
						
					});	
				},
				error: function(xhr, ajaxOptions, thrownError) {
					alert("error" + xhr.status +" " + ajaxOptions + " " + thrownError);
				}
		});
		
		var getData = function(){
				alert('hallo');
		};
	});	
	
</script>
<style>
	
</style>
</head>
<body id="tmp">

     <div class="group">
         <X3D width="700px" height="700px"  showLog="true" width="500px" height="500px">
            <scene>
                <Background skyColor='0.5 0.5 0.5'></Background>
				<Viewpoint position="50 0 2300"></Viewpoint>
				<Transform rotation='1 0 0 0.3'>
                <Transform rotation='0 1 0 -0.3'>
					<Shape>
						<Appearance>
						  <Material emissiveColor ="1 1 0"></Material>
						</Appearance>
						<IndexedLineSet colorPerVertex="false" coordIndex="0 1 2 3 0 -1 4 5 6 7 4 -1 0 4 -1 1 5 -1 2 6 -1 3 7 -1">
							<Coordinate point=" -500 -500 -500
                                                 500 -500 -500
                                                 500  500 -500
                                                -500  500 -500
                                                -500 -500  500
                                                 500 -500  500
                                                 500  500  500
                                                -500  500  500" />
						</IndexedLineSet>
                   </Shape>		
                   <Transform id="trans" rotation="1 0 0 -1.57079">
                        <Transform translation="0 0 -500">
                            <shape>
                                <appearance>
                                  <imageTexture id="texture1" url="http://kalyke.eox.at/eoxserver_timm/ows?service=wms&version=1.3.0&request=getmap&layers=IMAGE2009_rgb&styles=&transparent=true&format=image/png&crs=epsg:4326&bbox=35,4,49,18&width=1000&height=1000"></imageTexture>
                                </appearance>
                                <Rectangle2D id="rectangle1" size="1000 1000"subdivision='1 1' ></Rectangle2D>
                              </shape>      
                        </Transform>	    
                    </Transform>									
				</Transform>
                </Transform>
            </scene>
        </X3D>
    </div>            
   

</body>
</html>
